using System;
using System.IO;
using System.Collections.Generic;
using System.Drawing;
using System.Windows.Forms;
using System.Diagnostics;
using System.Text;
using System.Linq;
using ZedGraph;
using System.Management;

namespace SerialMonitor
{
	/// <summary>
	/// Description of MainForm.
	/// </summary>
	public partial class MainForm : Form
	{		
		//string recData = "28999,28919,29415,29207,28967,28903,28662,27958,28775,28967,28582,28630,28342,29159,28743,29143,28743,28679,29111,29239,28855,28871,29079,29191,28839,29047,28743,28903,29079,28630,29159,28983,29159,28534,29335,28775,28903,28983,29015,29271,28951,28999,28743,29351,28518,29223,29015,29175,28839,28743,29175,28967,28662,28775,28951,28823,28871,29831,28486,28791,28967,28406,28679,29367,29031,28518,28630,28422,28791,28903,28967,29095,28823,28903,28679,29239,28566,29015,28759,28775,28438,29015,28727,29047,28951,29063,28695,28855,28967,28486,28823,29319,29223,28791,29015,29143,28903,28983,28839,28887,29159,28855,29463,28582,28598,28855,29031,29399,28903,28711,29047,29095,29303,29239,28823,29207,29031,29111,29687,28855,28919,28582,28999,28903,29127,28823,28839,29399,29143,29127,28839,28951,28807,28839,28759,28727,28791,28967,29063,29175,29143,28743,29175,28422,29079,28679,28823,28038,28871,28550,29031,28807,28759,28743,29143,29079,29015,29015,28903,28967,28887,28887,28983,28679,28775,28871,28759,29079,28951,28951,28951,29239,28903,29143,29111,28871,28775,29175,28839,29095,28662,28775,29255,29031,29271,28839,28855,28967,29239,28598,28887,28967,29143,28903,29079,28807,28983,28999,28791,29239,29415,28887,28887,28727,29031,29143,28743,29079,29271,29079,29159,28679,29223,28903,29383,29351,28646,28999,28278,28999,28759,28871,28983,28871,29351,28711,28999,28919,28614,28967,28630,29207,29191,28727,29271,28999,29063,29015,28839,29303,29175,28935,28871,29111,29079,28614,28983,28903,28807,29207,28727,29415,28486,29335,28727,29047,29175,28919,28823,28662,29383,29143,28823,28791,28999,29063,28999,28935,29223,29287,29335,29143,28951,28855,29207,29239,29095,29559,29031,29431,29175,28999,28791,28983,29351,29127,28983,29399,28646,28919,29207,29207,29495,29063,28839,28935,28871,29335,29063,28999,28470,29191,28823,29095,28775,28951,29079,29143,29207,29175,28839,28727,29255,29047,29095,28598,29095,28951,28871,29207,28823,28919,28823,28871,29127,29127,29207,29303,29079,29239,28614,28775,28662,29031,28935,29031,29047,28999,28038,29063,28422,29303,29303,28935,29063,28919,28791,28967,29127,29047,29111,28855,29111,28935,28791,28839,29271,29255,28679,28967,29015,29047,29063,28935,29783,29207,29431,28999,29175,28839,28903,28679,29223,29239,28759,28791,29447,28967,28695,29415,28903,29031,28919,29047,29463,29031,28983,29447,29399,28422,28230,28518,27846,27366,26406,25974,25174,24453,23429,22725,21765,20517,19860,18932,17892,16612,16644,15427,15667,16003,15891,16884,17348,18276,19860,20356,22149,23573,24213,25334,26150,27430,27654,28518,28727,29031,29191,29175,28871,29607,28871,29271,29047,28999,28695,29367,29063,29239,29095,29143,28839,28903,29095,29015,29191,28999,29047,29127,29431,28999,29143,28855,29143,29207,28983,29079,29239,29191,29031,29239,29079,28919,28983,28679,28759,29127,28839,28871,29351,28887,28855,29095,28919,28903,28871,28839,29511,29287,29223,29527,29527,29015,28903,29111,29175,29447,29399,29031,29335,29399,28743,29175,28999,28919,28871,29127,29095,28646,28983,29095,29207,29031,29015,29015,29159,28935,28598,29175,28983,29255,28935,29175,29239,29623,28022,28855,29191,29047,29175,28791,29063,29463,28967,28999,29303,29335,28759,28550,29111,28999,29207,28807,29575,29111,28614,28983,29287,29095,29159,29079,28951,29143,29159,29223,28871,28967,29031,29015,28967,29191,29079,29239,28839,29095,29239,29623,28855,29111,29111,28518,65535,28935,28919,29031,29175,29111,29271,28983,29127,29367,29143,28582,28999,28566,29111,29079,28951,29223,29143,29079,29159,29287,28454,28935,29079,29175,29031,29511,28983,29079,29335,29783,29303,29031,29031,29015,28903,29335,29223,29047,28759,28983,29015,29239,28967,28743,28935,28871,29079,28262,28855,28983,28999,28695,29607,28502,28951,29159,28983,28919,29479,29335,29479,28695,29063,28935,28983,29175,29143,29303,28598,28871,29175,29063,28871,28999,29191,29159,29639,28534,28855,29399,28855,28871,28983,29399,28935,29223,29255,29127,28759,29415,28951,29111,28903,29463,29239,29095,28919,29239,28695,29239,29079,29383,28935,29191,28887,28887,29303,28967,29031,28983,28743,28630,29271,28646,28759,29191,29207,28967,29575,29031,29287,28999,28775,29223,29143,29159,28839,29175,29127,28983,29143,28951,29079,28983,29095,29111,28582,28743,28855,29527,28775,28791,29015,28518,29351,28935,29127,28871,28919,29431,29127,29111,29015,29335,29479,29207,29303,29351,28775,29319,29575,29015,28935,29463,29175,28951,29063,29543,29511,29111,29079,29559,28919,28871,28823,29383,29159,28791,28951,28855,28999,29015,29063,29335,29351,29175,28454,29095,28967,29031,28903,29015,29079,29111,28951,28807,29383,28470,28823,28967,29015,28839,28983,28550,28662,28807,28919,29079,29063,28807,29351,29047,29127,29175,29047,29239,28999,29223,28999,29735,29239,28775,28919,29431,28999,28662,28823,29751,29015,28935,29015,29015,29223,28807,29255,28967,29239,29383,29047,29207,29047,28743,29319,29335,29015,29015,29031,29239,29047,29127,28919,29303,29207,29127,29015,29127,29063,28759,28743,28855,28646,28919,29287,28614,29175,28967,29015,29031,28775,28887,29319,29271,29175,28310,28839,28919,29191,28502,28470,28983,28711,28775,28903,29447,29255,29111,28983,29111,29095,28887,28951,29063,28775,29239,29223,29303,28727,29191,28967,29031,29063,29239,29127,29287,29047,28759,29415,28871,29479,28823,28727,28919,29367,28871,28743,29047,29015,29111,28711,29191,28727,29159,28727,28630,29111,28951,28919,28935,28999,29047,29431,29015,29367,28743,28855,29543,28823,28903,28807,29015,28871,29271,29159,29175,29271,28743,28791,28855,29239,28727,28983,28871,28871,29063,28887,28823,28743,28759,28919,29175,29159,28791,29031,29079,29015,29335,29175,29239,28967,28999,29175,29111,29031,29175,28935,29159,28502,28967,28470,29463,29303,28935,28839,28454,29319,28887,28791,28759,28887,29383,29303,28855,28967,28951,28454,29111,29271,28855,28727,29383,29095,28775,29511,28695,29239,28743,28823,28598,28999,29031,29047,29079,28743,29095,29511,29383,29255,29047,28775,29159,29367,29175,29415,29239,28839,29223,29847,29063,28807,29095,28630,29271,29079,28999,28759,29159,28823,28887,28807,29399,29351,28358,28967,29127,29207,28887,29191,28550,29207,28903,28887,29015,29063,28903,28454,28935,29271,28695,28823,29063,28775,29047,28695,29191,28951,29143,29031,28871,28983,28919,28919,29015,28759,28983,29079,29351,29047,28999,29031,28999,28951,29239,29287,28839,29191,28775,29095,29159,29063,29271,29351,29447,29207,28903,29223,29015,29607,28887,29127,29223,29399,28662,28999,28919,29079,29255,29255,28951,28839,28743,28807,29063,29047,29431,29335,29287,29015,28887,29447,29239,29271,29223,28711,29255,29255,28983,28887,29335,28999,28871,28775,29335,29271,28823,28759,28470,29303,29143,28983,29047,29175,29287,29207,28919,28839,28887,29063,29047,29079,28727,28967,28807,28999,28887,29047,28390,29495,28887,29143,29207,29031,28743,28871,29287,29095,28951,28470,29207,28999,29111,28967,29223,28935,29191,29447,29031,29223,29175,29047,29335,29447,29143,28935,28839,28711,29031,29319,29095,28903,28999,28919,29543,28759,29047,28983,28967,29239,28919,28919,29447,29063,29207,28999,29143,29159,29143,29111,29191,29143,28855,28983,28679,28935,28791,29063,28983,29063,28566,28839,28855,28855,29143,28566,29047,29159,29031,29127,29143,28951,29367,28951,29207,29063,29383,28727,29047,29159,29239,29079,29303,29351,29559,28999,28646,29431,29191,29479,28951,29255,29063,28919,28983,28967,28983,29127,28775,28438,29047,29031,29127,29111,29111,28711,29255,29047,28919,28935,29271,28935,29319,29111,29735,28695,28743,28390,29335,29207,28807,29031,28871,28518,29015,28823,29319,29063,29015,28614,29175,28967,29159,28951,28855,29127,29031,29351,29479,29079,29159,29383,29255,28967,29271,29111,29287,29191,28775,29079,29143,28919,28951,28871,29271,29367,28727,28999,28999,29431,28887,29143,29047,29095,28839,28823,29159,29319,29447,29239,29079,29271,28871,28871,29447,29287,28871,29079,29063,28999,28823,29063,28582,28887,29063,28919,29255,28807,28598,28759,29367,29159,28967,28614,29175,28919,29159,28983,28999,29015,29015,29159,29015,28855,29015,28566,28695,29111,29111,28630,28791,28887,28935,29255,28759,29239,29143,28839,28470,29047,28823,29495,29191,28967,29191,28967,29351,29239,29287,29111,29223,29527,29287,29015,29303,28839,29063,28791,29303,28983,29319,29335,29079,29015,29143,28935,28983,29335,28711,28887,28999,28855,28967,28887,29207,29047,29143,28919,29239,28839,28919,28935,28807,28662,29271,29335,29399,28967,29079,29031,29383,29351,29287,29095,29447,28887,29463,29031,29383,28887,29047,28935,29127,28743,28983,28871,29303,29015,29047,28855,29047,29191,29063,29031,29223,29223,29223,28871,29079,29207,29303,29095,29015,29207,29207,28823,28807,28662,28919,28887,28999,29287,28358,28951,28919,28999,28935,28711,29143,28967,29527,29111,29031,29175,29079,28502,29335,29015,28679,29127,28967,29383,29079,29207,29047,28727,29223,28983,29175,28983,29255,28855,29159,28646,29159,29175,29303,28903,29015,28807,28967,29079,28983,28871,29015,29223,29175,28791,29127,28759,28727,29095,28470,29255,28871,28983,28775,29527,28903,29223,28791,29095,29015,29223,29159,28951,28999,28887,28871,29191,28839,29319,28823,28919,28358,28887,28919,29303,28935,29447,29335,28967,29079,28935,28919,29111,29079,29367,28679,29511,29271,29031,29095,28823,28999,29015,29159,28839,29559,28006,29047,29719,29415,29239,29079,28951,29031,28807,28999,28855,28839,29431,29239,29271,28711,29223,29383,28566,29047,29111,28983,29351,29095,29143,29351,28983,29063,29079,29191,29111,29687,29271,29335,29175,28598,28967,29367,29063,28903,29511,29111,28887,28999,28983,29319,29031,29399,28935,29383,28727,29159,28871,28807,28502,28711,29143,29111,28999,29063,28967,28406,29239,29079,29271,28855,28983,28919,29079,29063,28951,28438,29431,29143,28951,28807,28855,28791,28839,29447,28903,29527,29847,29047,29335,29239,29031,29319,29175,29047,28807,28935,27846,27782,27222,26934,25766,25286,23989,23509,21941,20933,19412,18564,17684,16836,16099,16532,16500,16580,16179,16884,16580,17044,16740,16964,17396,18468,18900,20020,22053,22997,24469,25190,26790,27206,28150,28807,29127,28903,29143,28839,29655,28967,29207,28967,28807,28711,29383,29303,29271,29351,29399,29079,28935,29671,29095,29207,29159,29111,29079,29239,28791,29319,29383,29511,29015,28839,28903,29207,28871,28951,28791,28903,29031,28999,28759,29351,29015,29351,29063,29287,29127,29479,29063,28342,29047,29335,29271,29175,29175,29063,29303,28711,29127,28871,29287,28903,29159,29287,29047,28759,29367,28695,29303,29335,29143,29287,29063,29591,29175,29111,29319,29127,29047,29303,28791,28935,28999,29143,28855,29463,28791,28871,28999,28999,29255,28903,28855,28791,29255,29127,29063,28807,29079,29463,29255,29095,29303,29591,65535,29095,29319,29271,29143,28903,29335,28534,28823,28999,29431,29191,28807,29639,29047,29191,28743,28598,28518,28967,28823,28967,29239,28502,28791,29271,29143,29463,29127,29255,28887,29047,29383,28983,29047,28679,28903,29111,29271,29031,28743,29255,28935,29095,28871,28951,29351,29095,29287,28550,29095,29351,29127,28983,29079,28855,29223,28967,28903,29447,29159,29319,29207,29287,28983,29239,29495,29079,29047,29703,29399,29031,28935,29863,29063,29095,28903,29159,28807,29255,28935,29431,29383,29415,28903,29159,28999,28871,29511,29095,28935,28839,28807,29239,29143,29127,29127,28855,29255,28967,29511,29111,29015,29159,29143,28919,29975,28951,28855,29063,28903,29287,29015,28999,28951,29191,28791,29287,29047,28759,29015,29383,29351,29431,29431,28839,29207,28951,28999,29703,28566,29383,28454,28999,28598,28823,29063,29223,28903,29111,28935,29047,28919,29319,29191,29175,29303,29143,29239,29463,29351,29015,28727,28887,28903,29511,28903,28390,29079,28871,28855,29335,29031,29063,28983,29271,28727,28983,29175,28582,29015,28871,28951,29175,29015,28662,29143,28775,29479,29351,29015,29479,28935,29527,29207,28999,28951,29271,28759,28983,28919,29015,28999,29447,28150,29175,28759,29079,29191,28823,28775,28630,28999,29447,28983,28983,29351,29223,28823,29095,29351,28999,29063,28791,29255,29463,28951,29015,29031,29319,28630,28983,29063,28839,29287,28326,29319,29079,29207,29335,29015,29159,29191,29239,29271,29351,29143,29623,29015,29575,29287,29127,28823,29143,29031,29463,29687,29463,29767,28775,29207,29287,28951,29063,29463,29191,29079,28839,29799,29063,29143,28198,29767,28582,28951,29399,29495,28903,29143,29031,29399,29159,28999,29255,29351,29223,29463,29127,29447,28646,29191,29415,29111,29399,29063,28198,29319,29255,29111,29591,28695,29223,28935,29223,28807,29127,28887,29223,28887,29127,28630,29303,28887,28775,29095,29207,28999,29271,29047,29191,28999,29479,29095,28983,29079,28951,29111,29015,29159,28646,29175,29015,29335,28919,29511,28935,29063,29223,29271,29367,29207,29431,29239,28775,29687,29319,29223,29031,29223,28887,29127,28903,29591,29271,28903,29047,28951,28903,29015,29047,28791,29063,28999,29447,28743,29303,28646,29335,29127,28598,28662,29079,29015,29079,28807,29111,29383,29031,28662,29671,29175,28422,28935,29223,28662,29335,29287,28791,28791,28919,28662,29015,29095,28919,28679,29111,29015,28807,28807,29223,28951,29639,29031,29047,28967,29127,29479,29079,29447,29431,29063,29623,28727,29015,28839,28823,29383,28999,28951,28999,29191,28887,28935,28614,29447,29127,28887,29063,29175,29415,28855,29383,28951,29159,28502,28983,29335,29463,28887,29159,28807,28438,28983,29383,29015,28695,28887,28502,29079,29143,28935,28999,29175,29111,28887,29191,29143,28983,29207,29367,29223,28871,28887,29399,29127,29351,29191,29751,29079,29287,29223,29255,29271,29303,29207,29223,29239,28999,28679,29975,29239,28919,29079,28390,29063,28807,29079,28951,29095,28807,28342,28951,28791,29575,29191,29335,28967,29143,28807,29047,28871,29127,29303,29287,29079,28791,29015,29111,29143,28903,29063,28727,28550,29175,28999,28999,29143,28903,28967,28727,29047,29175,29111,29127,29367,28759,29015,29319,29255,28662,29207,29719,29223,29287,29063,29559,29271,28887,29079,29047,29047,29047,28534,28967,28807,29335,28903,29127,28919,29399,29287,29223,29015,29383,29399,28839,28967,28839,29191,29239,28807,28967,29335,28743,28903,28935,28983,28967,29255,28999,28807,29015,28999,29159,28983,29127,29255,29047,29159,28695,29207,29415,29223,29127,29127,29047,28679,28999,29511,29655,29079,29415,29031,28118,28951,29079,28759,28871,28855,29047,29063,28983,28823,29415,29047,28903,29047,29175,29095,29143,29255,29799,29367,29399,28983,28935,29463,29079,29687,29095,29223,29191,29335,29303,29591,29127,28999,28662,29415,29175,29207,29191,29447,28919,29159,29063,29175,29175,28999,28983,29127,29127,28759,29447,28839,29335,29207,28951,29191,29191,29655,29319,29191,28871,28871,29015,28983,28871,29111,29383,28614,29079,29047,28871,28983,28823,29207,28855,29063,29207,29159,29415,29127,28614,29271,29415,29415,29111,29111,29047,28855,29191,28983,29191,29111,29159,29111,29351,28999,28871,29047,29623,29527,29351,29015,29031,28887,29079,29399,29239,28983,28967,29287,29239,29127,29191,29463,29191,29255,28935,29207,29207,29287,29175,28967,29271,29223,28855,29255,28566,29447,29159,29095,29095,28887,29111,29159,28470,28967,29047,29127,29159,29271,29543,29127,28855,28887,28791,28823,28951,29079,29175,28374,28935,29431,29015,28711,28951,29175,29015,29175,29399,29063,29095,28679,28662,28951,29063,29223,29047,28999,28951,29351,29175,28919,29911,29223,29031,28743,28807,28919,29111,29287,29479,29079,29335,29159,29047,28871,28951,29287,29047,28935,28807,29143,29111,28887,28566,28935,29079,29575,29175,28903,29463,28935,29031,29079,28695,28951,28903,28855,28935,29335,28983,29015,28791,29239,28919,29127,28759,28855,28903,29207,28935,29047,29399,29367,29063,29143,29335,29095,28951,29111,29207,29143,29623,29063,29031,28887,29095,29047,28951,29079,29319,29079,29239,29079,28935,28935,28518,29143,29127,28518,29479,29111,29239,28839,29383,28935,29015,29207,29095,29655,28935,29271,28967,29159,29287,29479,29367,29207,29191,29127,29079,29159,28807,28839,28791,29063,28871,28807,28839,29047,29063,29095,28839,29047,29111,28983,28711,29143,28999,29143,29207,28598,28470,28999,28775,29623,28999,28839,29047,29191,28983,28951,29111,29351,28855,29143,28839,29031,29079,29111,29207,29383,29159,29175,28919,28823,28454,28759,29095,29287,29287,29367,29319,28871,29063,29415,29111,28887,29015,28791,29111,28727,29207,28855,29607,28935,28855,28983,29431,29031,28903,29015,28983,29575,28727,28935,29079,28855,28807,28839,29111,29143,29079,28903,29031,29111,28919,29495,28839,28775,28679,28999,29143,28951,29399,29431,29031,28951,29319,28775,29431,28999,29287,29159,29559,29063,28951,29047,29095,28903,29255,29591,28951,29287,29111,29031,28887,29111,28390,28951,28775,29047,29191,29319,29431,29447,28999,29207,28871,29031,28903,29047,28534,29111,29015,28855,28903,28566,28935,29031,28662,29015,28598,28791,29031,28775,28935,29111,28791,29111,28823,28935,29079,28967,29191,29031,28823,29143,28855,28855,28855,29399,28999,29207,29495,29479,28919,29399,28807,29271,29031,29047,29383,28855,28743,29511,28967,28951,28983,28695,29063,28951,29399,28727,29623,28871,29015,28983,29143,28566,29335,28951,29191,28502,29175,28582,29351,29175,28823,29079,29175,29015,28935,29143,28999,29047,29255,29079,29015,29047,28951,28903,29159,28887,28246,28278,27462,26870,25798,25894,24437,23445,22981,21381,20340,19284,18212,17236,16307,15555,14931,14531,15331,14851,14995,15443,16307,17636,19076,20629,21669,22597,24341,25318,26198,27222,28070,28550,28630,28935,29191,29239,28999,28486,29287,29111,29127,29031,28967,29239,28919,28614,29079,29271,29031,29095,28935,28759,29015,29143,29351,28919,29191,28887,29287,28951,28839,28951,28983,29239,30103,29207,29207,29143,29543,29079,29127,28871,28807,28967,28903,28695,28935,29271,29415,29303,29111,28855,28839,28711,28759,28598,28278,29463,29543,29047,28727,29063,28887,29223,29111,28679,28374,29159,29191,29063,29271,28951,29015,29847,29143,29271,29271,29159,28951,29223,28470,29031,28711,28823,28871,28807,28374,28919,29143,28855,29207,29255,29031,28839,28518,28967,29143,29239,28951,28871,29111,28679,28823,29015,28711,28743,29031,28999,28887,29463,29047,29079,28246,29255,29095,28807,28470,29063,28983,29063,28839,28390,28855,29639,29063,28855,29111,29591,28935,28807,29191,29095,29367,29431,28342,29191,29223,28999,29175,29047,29015,29543,29191,28903,29463,28887,28743,29191,28935,29111,29143,29223,28983,29127,28935,28855,29063,29287,29495,29223,29319,28839,29287,29319,29239,28871,28438,28983,28999,28502,29159,29143,29175,28823,28967,28759,28983,29287,28566,29239,28759,28406,29159,28887,28855,29079,29879,29319,29271,29079,29271,28935,28855,28839,28983,29191,28935,28679,29287,28919,28887,29047,28534,29095,28775,29319,29079,29271,29255,29175,28871,29287,28743,29159,28951,28951,29367,29031,29639,29015,29287,29383,29255,29079,29175,29207,28759,29159,29255,28775,29111,29255,29095,28839,29111,29047,29127,28935,28967,29191,29431,28582,29159,29111,29175,29703,29047,29239,29111,28598,29175,29399,28727,29335,29031,29191,28646,29367,28582,29751,28919,29143,28566,29239,29015,29159,28951,29127,28951,28855,29047,28823,29239,29687,28743,29319,29223,28695,28967,29095,29335,29095,29879,28534,29015,29271,29031,29159,29319,28679,29031,28775,28711,29159,28935,29159,29079,28839,29735,28823,28839,28919,29127,29527,29031,29047,28935,29495,29351,28903,29655,29095,28951,29351,29175,29495,29095,29159,29047,28679,29303,29047,29031,29079,29431,29079,29303,28695,28438,28887,28887,29111,29015,28919,28935,29191,29239,28807,29303,29255,29095,29111,28823,29095,29031,29527,28518,29271,28919,29287,29015,29367,29031,29111,28935,28807,28823,29143,28855,29079,28614,28983,29223,28711,28695,28887,29127,28887,29303,29031,29143,28759,29271,29111,29559,28630,29079,29207,28855,28582,29287,29015,28967,29063,28390,28646,28887,29031,28855,29383,29239,29303,28855,29207,28582,29351,29191,29031,29287,29239,29223,28839,29815,29351,29383,29223,29079,29095,29207,28871,29079,28951,29623,29031,29159,28727,28871,29319,28871,28871,28983,29079,28422,28630,28614,28662,28534,28919,28679,29255,28486,29079,28999,28999,29735,29191,29351,29047,28711,29047,28791,28839,29079,29079,28454,28967,29479,28727,29447,29207,28887,28983,29127,28999,29271,28999,28999,29159,29367,29367,29383,29159,29543,29367,28935,29111,29191,29575,29127,29319,28935,29191,28919,29575,29031,28711,29319,29415,29271,29687,28903,29239,28935,28470,29191,28887,29159,29175,28999,28999,29463,28967,29399,28791,29063,28983,28951,29031,29239,29111,28983,28807,29079,29047,28646,29143,28695,29367,29047,29095,29031,29079,28983,29175,29287,29447,29255,29399,29511,29287,28983,29095,29767,29207,29271,28855,28983,29159,29079,28967,29127,28919,29607,29175,29111,28967,29399,28999,29207,29047,28935,29223,29063,29063,29047,28999,29287,28983,29111,28807,29207,29063,28887,28823,28743,29591,28903,29351,28919,28951,28919,29335,28919,29159,28983,28518,29047,29127,28823,29095,28935,29031,29159,29047,29015,28438,29095,28791,29511,28967,29191,28839,28903,28887,28999,29079,29335,29271,29319,29335,29047,29063,28935,29111,29079,29111,29239,29255,29383,28871,29271,29239,28871,29271,29095,29095,28887,29367,29127,28791,29735,28919,29367,29223,29191,28598,29207,29063,29191,29351,29079,28999,29159,29191,28727,29335,29399,29447,28935,29431,28903,29079,28679,28855,29319,28823,29079,29495,29095,29127,28871,28823,28871,29079,28999,29047,29383,28871,29223,29095,28839,28999,28855,28679,29143,29367,28518,29191,29175,28903,29111,29399,29303,28278,29127,29127,29351,29015,29239,29015,29159,29143,29143,28935,29511,28919,28999,29239,29303,29703,29335,29591,29143,28951,28887,29383,29271,28566,29703,29367,29463,29111,29351,29191,29383,28983,29271,29319,29175,29047,29319,29095,29207,28855,29351,28871,29159,29015,29095,28999,29079,28999,29271,28999,28983,28999,28887,29383,28871,29287,28775,29415,29351,29207,28935,29047,28390,29159,29079,29159,29319,28791,29207,29127,28887,28743,29015,28935,29143,28775,28999,29207,29223,29239,28999,29175,28967,29143,29255,29079,29303,28550,29367,29223,29335,29415,29399,29095,29335,29191,28791,29319,29415,28887,29031,29207,29495,29207,28759,28903,29127,29143,29143,29015,28983,29847,28951,29431,28951,28919,28951,29383,29159,29159,28983,28903,28951,28630,29047,28999,29431,28775,29015,29335,28727,29223,29063,29015,28967,29415,29223,28839,29031,29223,28935,29543,29287,29111,28871,28903,29223,28871,29255,29239,29143,29415,29367,28935,29127,28919,29143,29207,28823,29095,28855,29127,28983,29255,28999,29127,29095,29239,28999,29223,28919,29063,28422,29015,29175,29239,29255,29127,29015,29191,28406,29383,29079,28919,28759,28967,29319,28903,28871,29079,29303,29143,29191,29271,29191,29143,29191,29047,29223,28887,29143,29063,29255,29175,29031,29095,28983,28999,29399,28983,29143,28646,28951,29303,28999,28807,28871,28454,29127,29463,29303,28823,29447,29015,29303,28903,29127,28807,29303,29319,28951,29127,28967,29031,29159,29239,29303,28775,29175,29223,28935,29223,29127,29047,28711,29175,29463,28855,29031,28951,29111,28983,29175,29271,29047,28582,28839,28967,29255,28839,29255,29223,29223,29111,29255,28855,29271,29015,29559,28951,29159,28983,28999,29223,28390,29079,29191,29063,28743,28935,29207,29079,28903,29191,29207,29031,29191,28999,29159,29303,28999,29031,28759,29063,28695,29175,28935,29063,29223,29207,28999,28999,29095,29031,29191,29351,28823,29143,28999,29143,28550,29399,29191,28967,28775,28935,28935,28887,28983,28823,29079,29287,28919,28999,29271,28791,29335,29335,29559,29143,29095,28983,28983,29495,28967,28406,29399,28695,28839,29079,29095,28759,29063,29239,29191,28839,28727,28823,29127,28534,28887,28983,28679,29351,28999,28775,28871,29223,29271,29287,28582,29175,29287,29351,28711,29063,29175,29415,29031,29239,28887,29319,29031,29127,28711,29063,28855,29239,28903,28823,28935,29351,28855,29143,28807,29143,29079,28871,29527,29095,29319,29495,29367,29079,28823,28871,29175,29239,29175,28983,28983,28999,29031,28999,29367,29079,28951,29079,29111,29031,29127,28358,29079,29271,28983,29063,29447,29095,29271,28967,29031,28727,29351,28438,28759,29303,29143,28727,28951,28711,29095,29271,28999,29015,28406,29031,28935,29191,29383,28935,29223,28903,29111,29111,28614,29239,28983,28951,29095,28871,29079,29463,29383,29191,29143,28855,28967,29095,29511,28695,28935,29255,29303,28695,29303,29223,29943,29639,29431,29175,29607,28727,28983,29191,28743,29143,28983,28727,29447,28823,29543,29319,29319,29127,29239,28903,28903,28246,29047,28999,28999,29255,28871,29127,28534,29543,29015,28679,29831,28951,29095,29159,28999,28951,28935,29271,29031,28791,29239,28903,29095,29239,29287,29111,29159,29415,28775,29623,28839,28695,28935,29287,28614,28983,28983,29479,29095,29207,29015,28630,29159,28422,28214,27910,27654,26518,25910,24646,24389,23477,22789,21541,20084,18900,17972,17108,16163,16115,16019,16211,15939,15619,15843,15507,15891,15987,16772,17988,19076,20485,21957,23157,24790,26182,26470,27990,28134,28422,28823,28759,29383,29255,28759,28518,28999,28871,28791,29303,29575,29143,28983,28807,28967,29511,29239,29159,28919,28727,28935,29367,28727,28871,28999,28967,28839,28855,29079,28775,29063,29095,29063,28759,28743,28919,29015,29303,29111,29223,29319,29095,29015,29127,29303,29575,29271,29207,29335,29207,28727,29287,29111,28887,28887,29463,29207,29079,28807,28983,29287,28727,29031,28855,28791,29287,28807,28807,28807,29143,29015,28903,28919,29463,28967,29703,28807,29591,28855,29271,29175,29287,29063,28839,29223,28791,29095,28935,28983,29623,29271,29287,29239,28935,28935,28935,29399,29127,29527,29095,29111,29287,28855,29847,28919,29175,28550,29191,29015,29111,29559,29559,29111,29095,29095,28871,28983,29031,29031,29207,29175,28534,28807,29127,29655,29079,29079,29191,28871,29255,29159,28646,29223,28791,29367,29479,28983,29015,28791,29911,29143,29383,29319,29447,29111,28919,28727,28935,28903,28983,29063,29191,28935,28839,29239,28871,28951,28855,29095,28919,28807,29191,29143,28903,28999,29287,29207,28679,29111,29223,29159,29127,29079,29239,28935,29207,29447,29255,28983,29255,29175,29031,28967,29015,29719,28839,28518,29031,29063,29095,28903,29751,29111,29111,29639,29383,29015,29047,29927,28967,28935,29063,29431,28646,29127,29207,29287,28711,29239,29287,29095,28855,28679,28871,29047,29047,28759,28887,29047,28775,28919,29111,29319,28807,28999,29079,28839,29303,29063,29207,28759,29127,29159,29191,28999,28935,29223,29511,29031,29063,28871,28887,29175,28775,29687,28759,29095,29191,29351,29223,28871,29159,28775,28935,29159,29095,28967,29143,29447,29351,29015,29351,29047,28999,29223,29383,29207,29351,29095,28983,28967,28839,29127,28582,29367,28887,29063,28871,29367,28919,28679,29031,28695,29063,29431,29239,29063,29671,28614,29287,28695,29031,29031,29383,28614,29223,29063,29559,28839,29319,28646,29143,29383,28903,28759,28454,29223,28935,29655,28951,29223,29095,29191,28983,29111,28919,29223,29399,29175,29447,28871,29287,29415,29751,29303,29671,28887,28887,28935,29303,29159,29047,29111,29015,29095,28951,29335,28887,29111,29031,28775,29719,29447,28775,29479,29223,29047,29223,29031,28839,29223,29495,29047,29143,29255,29127,29127,28823,29239,28951,28791,29143,29159,28951,29047,28935,28903,28743,28839,28662,29095,29287,29127,29175,29143,29143,29143,29447,29015,29031,29655,29671,28598,29319,29239,29255,29143,29143,29127,29543,29399,28807,29047,28630,29031,28759,29271,29095,29047,28791,29479,29303,29303,29383,29015,28967,29047,29255,28823,29463,29175,29367,29031,29239,29223,28999,29191,28823,29367,29255,28775,29015,28935,28727,28967,28695,29079,28871,29175,28823,28999,28999,29351,28951,29335,29191,29223,28935,28999,28807,29239,29047,28711,28999,29175,29287,28839,29095,29031,28919,29223,29255,29367,28759,28967,29559,29351,29095,29015,28871,29239,30007,28775,29335,28855,29159,29175,28983,29079,29287,29591,28983,28326,29159,29159,29223,29303,28582,29319,28759,29367,29239,28983,28967,29015,29031,29175,28887,29511,28839,28775,28967,29511,29415,28791,28342,28983,29159,29063,29223,28871,29015,28310,29591,29015,28871,28903,28791,28823,28454,28727,29127,29303,29031,29271,28903,29015,28855,29015,28887,29175,28534,28951,29543,28887,28406,29063,28598,29191,29287,29127,29511,29111,29319,29207,29335,29367,28614,29095,29207,28967,29175,29095,28983,29111,29175,29079,28967,28935,28935,28919,29287,28919,29143,28983,29335,29015,28967,29127,29351,28903,28614,29031,29399,28999,29047,28903,29799,29031,29191,29255,29239,29143,29111,29031,29015,29207,28823,28903,29319,28983,28310,28903,28999,29127,29415,29095,28935,29143,28967,28903,29255,29287,28999,28823,28727,28983,29111,28871,29399,29127,29287,28919,28903,29047,28935,28807,29111,29767,29191,29287,28903,28903,29127,29031,29479,29063,29015,29319,29015,29191,29063,28951,29575,29079,29143,28967,29447,28919,28839,28951,29383,29031,29431,29079,29159,29335,29079,28871,28743,29559,29591,28759,29447,28983,29431,28759,29095,28903,28614,28887,29047,28855,28967,29271,29095,28935,29079,29223,29335,28919,29047,28839,29095,29143,28871,29143,28775,29015,28919,29319,29015,29351,28983,28983,29463,29239,28951,28919,29207,29175,29143,29175,28951,29367,29191,29031,29623,29095,29255,29031,28775,28775,29063,28887,28679,28807,29047,28967,28919,28598,29031,29143,29175,29063,28839,28983,29319,29079,29095,29255,29095,28871,29911,29543,29159,29127,29143,28951,29223,29271,28999,28935,29399,29479,28711,29143,29111,28855,29031,29031,28518,28983,28550,29031,29399,29335,28727,29207,29607,29319,28887,29175,29255,29095,28903,28807,28582,29159,28999,29319,29559,29239,28807,29095,29335,28807,29415,29287,29175,28662,28759,28598,29527,28871,29399,29031,29399,28967,28935,29223,29751,29431,29367,29351,29143,29399,29159,28983,29719,28711,29095,29031,29383,29015,28983,29207,28999,29047,28839,28807,29335,29159,28951,29223,28919,29143,28951,29079,29303,29255,28855,29383,28839,29111,29207,28967,28775,28711,29287,29271,29367,29399,29431,28967,29319,29127,29015,28887,29111,28935,29127,28967,29223,29335,29079,29015,28791,29207,29271,28983,29303,28983,28983,28759,29175,28807,28983,28839,29351,28775,29159,28999,29095,28855,28951,29015,29175,29095,28807,29143,29191,29527,29703,29015,29159,28470,28839,29079,28887,28695,29207,28775,28711,29015,28983,29255,29223,28999,28839,29207,29255,29207,28550,29207,28887,29463,28807,28871,29031,28887,29239,29159,28839,29111,28839,29255,29351,28983,29127,28839,29431,28711,28727,28935,29143,29159,28871,28919,28919,29095,29031,28967,28951,29159,28903,28919,29047,29191,29383,29239,29239,28935,29255,28775,29383,29367,29271,28823,29383,28919,29015,29175,28646,29399,29079,29559,28791,28679,29783,29063,29047,28727,28791,28614,29127,29159,28711,28646,28727,29127,29095,28855,29463,29415,28839,28823,28887,28919,29223,29063,29431,29255,28823,29191,28935,29159,28983,28470,28470,29095,29015,28983,29031,28999,29143,29191,29319,28839,29351,29143,29079,28326,28727,29015,29095,28759,28871,28887,28759,29255,28983,29127,29159,28807,28951,28935,28823,29159,29367,28903,29511,28871,28935,28727,29127,29079,28839,28743,28823,28903,29095,29127,28855,28935,28903,29255,28839,29335,28518,28935,29271,29063,28646,29143,28855,29431,29127,29031,28679,29031,28919,29239,29319,29287,29319,29495,28983,28871,29159,28823,29303,28566,29095,29127,29111,28775,28294,29271,28855,28871,28999,28887,28903,28823,29511,28823,28566,28983,28855,28839,29159,28887,29143,28871,29207,28823,28967,29319,29495,28999,29383,29159,29047,28935,29399,28967,29271,29063,28502,29623,28887,28903,28967,29159,28727,29111,28935,29927,29031,28983,28614,29431,29351,28727,29079,28999,29111,28967,29111,28887,28951,29207,29159,28903,28855,28839,28743,28807,29095,28983,28935,29031,29255,28743,28454,28983,28855,28935,28839,28807,28454,28727,28743,28935,29543,29207,28807,29207,29207,29207,29399,29207,29447,29447,29127,29367,29367,29143,28759,29287,29063,29047,28695,29127,28791,28775,28983,29367,28679,29063,29031,28775,28919,28823,29207,29015,28999,29047,28887,28951,29111,29223,28679,28935,28967,29447,28967,29287,28775,29367,29639,29095,29623,29095,28983,29335,28855,29159,28759,29127,28759,28887,28486,29095,29031,29111,28775,29159,28999,29287,29255,29207,29031,28727,29239,29239,29431,28903,28743,28390,28294,27446,26982,26182,25542,24437,23893,22677,21365,20084,19300,17508,17188,16580,16596,17092,17332,17092,16884,16708,17556,17252,17508,17476,17252,18308,19892,20485,21909,23445,23685,25958,26518,27142,27878,28775,28566,29175,28887,29351,28727,29031,29111,28855,29239,28967,28614,29095,29191,28727,29911,29143,29335,28630,29655,28807,29319,28711,29287,29095,28470,29159,29175,29095,29159,28871,29271,29015,28566,29447,28983,29303,29159,29015,29015,28999,28871,29095,29111,29111,28855,29383,29303,29079,29063,29319,28919,28935,28646,29063,29031,28534,29271,28871,28743,28775,29159,29239,28422,29111,28374,28679,29335,29223,29127,28839,29623,28983,29047,28695,29463,28983,29079,28983,28775,28695,29015,29095,28582,29303,28999,29351,29031,29111,29303,29159,28679,29191,28711,28951,29047,28903,28711,28967,29239,28695,29479,28967,28662,28839,29239,29143,28999,28807,29367,28775,29399,29223,29255,28983,28727,29335,29623,28839,29111,29191,28598,29015,28775,29143,28855,29175,28646,29111,29367,29287,29367,29351,28999,28951,29047,29415,29095,29271,29143,29095,29095,29255,29319,29079,29111,29111,29255,29015,29127,28855,28967,28775,28919,29207,28711,28502,28630,28711,28903,28791,29303,28855,29063,29335,29255,28711,29479,29079,29255,28438,29591,29367,28983,28951,29079,29047,28534,29015,29175,28839,28951,28871,29415,29015,29287,28823,29015,28823,28855,28903,29095,29335,29079,28326,29063,29111,29463,29271,29255,28534,29351,28999,29751,29351,28967,28903,28582,28983,29335,28983,29063,28903,29063,28967,28598,29367,28935,28999,28791,28775,29319,29143,28679,28967,28871,29367,29239,29047,29015,28646,28871,29239,28855,28486,29127,29111,28582,28887,29175,28983,28871,28823,28887,28438,28855,28935,29159,28855,28887,28999,29223,28983,28406,29335,29111,29127,28839,28871,29383,28983,29159,28775,29047,29079,28727,28919,28695,28935,29015,28983,28759,29415,28999,28903,28759,29863,28823,28855,28711,29063,28855,28662,29367,28855,29031,29031,29303,28743,29095,28518,28582,29127,29351,29015,29047,29063,29319,28743,29303,29095,29031,29015,29175,28935,28807,29175,28566,29303,28566,29191,29063,28823,28614,29127,28903,28871,28999,29223,28582,29079,29015,28534,29351,28839,29223,29063,29047,29015,28695,29111,28855,29031,28919,28935,28871,29319,28999,29191,28903,28951,28534,28518,29063,29047,28614,29383,28999,29143,29351,28646,29511,28855,29639,29431,29047,29383,28935,29111,28679,28871,29079,28743,29047,28807,28807,29239,28550,29367,29079,28775,28887,28759,29079,29191,29063,29207,29207,29207,28807,28839,29559,29415,29223,29079,29095,29079,29127,29127,29351,28871,29031,28646,28903,28983,29047,29383,29255,29223,28390,29191,29143,28743,29159,29351,28614,29431,29479,29127,28983,29079,29255,28807,29463,29335,29367,28903,29015,28871,28486,29015,29463,28871,29015,28438,28935,29255,28662,29335,28935,28791,28711,28999,28791,29351,28695,29159,28903,28823,29863,29063,29575,29015,28903,28999,29351,29047,29479,28823,28871,28743,29079,28646,28807,28871,28871,29079,29079,28935,28951,28662,28646,28871,29159,28919,28871,28951,29319,28999,29191,29303,28951,29063,29831,28855,28727,29079,28502,29175,28759,29319,29127,29159,29015,28967,29255,28967,28903,28743,28967,29031,29143,28775,28582,29063,28935,28903,29047,29431,29303,28919,29159,28534,29143,29207,29287,28871,29047,28983,29079,29063,28919,28791,28646,28935,29175,28791,28967,29159,28791,28871,29143,28967,29479,29063,29335,29047,28887,29031,28887,28534,28823,29031,28775,28839,29831,29111,28695,29559,29463,28775,29303,28807,29207,28871,29271,28935,28983,28695,29207,28871,29015,28775,29095,29063,28823,28935,29159,29239,28919,29239,29063,28935,28807,29031,28711,29415,29287,29271,28598,29015,28630,29111,29431,29111,28743,28614,28951,29047,28855,29575,29063,29079,28999,28871,28855,29287,29303,29015,28983,28791,29255,29335,29191,28743,29191,28983,28951,29191,29399,29079,28919,29031,29479,29255,29095,29063,28406,29223,29175,28743,28823,28262,29143,28759,28502,29111,29015,29239,29959,29079,29575,29159,28951,28855,29223,28823,29223,29175,29031,29207,28919,28919,28759,28871,29271,28743,29191,28823,29031,29063,29127,29159,29047,28614,28550,28967,28582,29223,28711,29495,28999,28855,28903,28791,28951,29431,29383,28983,28807,29239,29015,29335,28951,28662,28983,29175,29031,29255,28406,29175,29079,28983,29047,28919,28903,29031,29031,28839,29335,29079,29063,28951,29047,28903,29207,28438,28518,28839,28951,29159,29143,29143,28775,28791,29175,29335,29143,28935,28871,28855,28999,29063,28903,29111,28582,29111,29207,28999,28983,29687,29431,29079,29575,28951,28903,29047,28871,28727,29063,29223,29063,28823,29079,28695,28823,28855,29287,28935,29175,28791,28919,29127,29031,28935,29223,28855,28727,29175,29223,28983,28743,29607,28630,29463,29175,28887,29223,29319,29159,29671,29783,29015,29607,29127,29111,28406,29191,28919,28967,29079,29479,28871,29095,28967,29255,29223,29239,28727,29111,29127,29079,28919,29335,28935,28807,28999,29127,28951,29239,29047,29063,29143,29319,28855,29239,28791,29095,29047,28903,29223,28887,28871,29191,29111,29255,29159,29015,29175,29591,29159,28791,28967,29015,28967,28951,29447,29463,28999,29271,29591,29383,29255,29543,29015,29271,28518,28839,29143,29079,29447,29463,28919,29591,29623,28887,29015,29047,29175,28791,29335,29031,29079,28935,29191,29079,28999,29143,28999,28775,28887,28935,29207,29207,29015,28999,28999,28983,29047,29367,28951,29335,28887,29271,29095,29479,28823,28839,28935,29527,29191,29271,29303,28919,29063,29367,29079,29127,28967,28951,29415,29047,28935,28967,28919,29079,28999,28807,29063,29015,28871,28759,29223,29015,28983,29175,28999,29143,28919,29159,29079,29415,29255,29143,29095,29223,28951,28951,28999,29095,28807,28695,29191,29335,28711,29111,29095,29303,28534,29351,29047,28903,28775,29063,29191,29111,29079,29431,29143,29015,29015,29063,29335,29063,29159,29239,28871,28791,29175,29287,29703,29015,29159,29063,28967,29335,29015,29431,28679,29047,29015,29239,28871,29223,29047,29383,29255,29143,28695,28855,29127,29559,28903,29303,29143,29047,29079,28951,28919,28775,29047,28823,29255,29319,28887,29063,29207,29063,28919,29175,28919,29111,29287,28791,29127,28967,29287,29095,29127,28983,29463,28999,29095,29031,28999,29063,29175,29335,28919,29031,28871,29015,28903,28983,29271,29063,28422,29127,29063,28967,29255,28871,28951,29575,29127,29159,29191,29079,29191,28743,29447,29063,29063,28807,29031,28759,29031,28855,29063,28887,28999,29015,29143,29095,29239,29431,29079,28951,28919,29175,29015,29847,29015,29527,29383,29287,29047,29399,29255,29015,29159,29047,29303,29399,28871,28871,29175,28743,29223,28903,28951,28727,28711,28743,29207,29783,29351,28743,28727,29575,28903,29063,28903,28967,28919,29047,28903,29527,28646,28903,29063,28919,28903,29223,29079,29191,28999,29223,28855,29287,28695,28759,29319,29287,29271,29239,29287,29127,29063,29063,29367,29399,29463,28646,29479,29063,29751,29127,29239,29047,29095,29095,28983,28967,28855,29159,28422,28951,29207,29015,28743,28999,29175,28566,28887,29367,28855,29191,29015,29287,29175,29143,29095,29047,29591,29111,28903,29095,28662,29175,28935,28839,28935,29591,29287,29127,29239,28502,29079,29095,28999,29111,29159,28999,29175,28919,29159,29095,29191,29527,29415,29015,28887,29367,29015,29127,29031,29399,29223,29335,28919,28775,29063,29159,28919,28342,28294,27910,27638,26870,26422,25542,24806,23717,22853,21845,21013,19732,19188,17956,17604,16900,16259,15587,15379,15763,16099,16452,17332,18932,19860,21189,22197,23765,24533,25974,26774,27462,28166,28518,28887,29063,28566,28871,29047,29463,28983,29431,29063,28823,29127,29015,29303,29127,29063,29255,28759,28935,29319,29239,29143,28662,28999,29095,28999,28967,29015,28999,28919,29303,28871,28935,28855,29047,29111,29191,29079,29191,28823,29143,29143,28919,29319,28951,28791,28759,28999,28871,28823,28791,28951,29175,28967,29335,29223,28967,29079,29159,28983,29079,29239,28887,29223,28839,28887,29015,29223,28951,28967,29047,29207,29031,29399,29047,29095,28951,29063,29223,29415,28983,29143,28999,28999,29063,29079,29031,29255,29127,29031,28919,29031,29527,29159,28743,28823,29495,28679,28775,28935,29239,28711,28983,28903,29095,28614,28983,28983,29415,28967,28983,29191,29031,29047,28807,28935,29047,28999,28919,28566,29095,28999,28935,29367,28967,29127,29239,29159,29511,29239,28951,28999,29015,29095,28871,28679,29335,29079,28646,28855,29111,29159,29287,28903,29239,28951,29111,29031,29047,29095,29943,29143,29239,28919,28903,28807,28999,29095,28807,29095,29207,28951,29303,29223,29655,29383,28823,29191,29207,28983,28711,29015,29287,28999,28791,28999,29031,28983,28919,28534,29175,29015,28422,29415,28983,28727,29143,28951,29111,29063,28967,28999,28983,29159,29127,29239,29431,28807,29399,29079,29239,29335,29079,28679,29559,28919,28983,28871,28951,29303,28839,29383,29111,29255,28550,28999,29063,29207,28695,29095,28871,28967,29143,28887,29207,29447,28935,28967,29079,28775,28919,28791,29383,29463,29399,28662,29415,29143,28935,29127,29191,28823,28598,28839,29063,29191,29271,28951,28791,29127,28999,29143,29159,29319,28999,29079,29271,28919,29127,29463,29175,29479,28823,29303,29175,29239,29159,29015,29239,29127,29255,28791,28999,28807,28999,28662,29207,29271,29159,28823,29015,29047,29127,28759,29399,28935,29111,28983,29495,29191,29063,29495,29015,29703,28951,29367,29063,29095,29591,28951,29111,29143,29239,29399,29335,29095,28839,28951,29207,29047,29239,29127,28967,29239,28662,29303,29095,29079,28967,28999,29191,29159,29127,28983,28839,28871,28759,28983,28967,28887,29399,28679,29015,29367,28823,29191,29191,29191,29223,28983,29095,29303,29095,28807,28406,28967,28470,28919,29319,29111,28614,29175,29143,29207,28775,29047,29079,29223,28951,28743,29111,28759,29239,29303,29159,29143,29127,28518,29095,28935,28887,28935,28983,28935,29127,28951,29047,29207,29271,29399,28919,28871,29031,28967,28406,29495,29175,29239,28823,29271,29031,29095,29063,29303,28598,28919,29223,29351,29159,28727,29095,28951,29351,29031,28823,29367,29303,29175,29431,28935,29239,28855,28759,29831,28342,28935,29223,29607,28871,28759,29335,28903,29159,29015,28983,29191,29111,28791,28951,29095,28807,28951,29207,29111,29575,29383,28871,29095,29287,28919,28983,29239,29511,29015,29063,29383,28855,29111,29495,29047,29623,28727,29399,28919,28887,29015,28823,29127,29559,28951,29047,29031,28967,29047,29303,29607,28951,29383,29079,29063,28967,29031,28855,28871,29191,28711,28951,29143,28791,28871,29095,29095,29223,28791,29431,28983,28999,29175,28967,29191,29447,28999,29239,28983,29431,29063,28598,29687,28759,28999,29095,28999,29223,28919,29095,29543,29783,29111,29063,29255,29463,28727,28887,29063,29143,29015,29031,29111,29335,29111,29399,28823,28935,28743,29751,28935,29063,28935,29351,28919,28967,28807,29175,29111,28727,29367,28390,28999,29527,28871,29303,28919,28999,29111,28887,29351,29015,29447,29271,29175,29207,28951,28951,28935,29511,28999,28454,29207,29271,28871,29015,28887,29127,29191,29303,29207,29847,29303,29463,29239,29175,28743,29319,29127,29383,29255,28967,29175,29463,28887,29015,28759,28775,29015,29063,29383,28807,28759,29127,29383,28935,29255,29271,29159,28855,29047,28871,29095,29415,29447,29271,29207,29079,29223,28887,29079,29175,28887,29287,29159,28759,28983,28871,28871,28743,28983,29367,29127,28839,28983,29127,28727,29335,29079,29207,28983,29191,29031,29367,29015,29111,29015,29383,29127,29223,28951,28999,29079,29047,28711,29015,29143,29159,28999,28903,28999,29303,32247,28711,29111,29239,29095,28695,28919,29143,29159,28935,29319,29559,28935,29335,28983,29335,29143,29431,28983,29207,29079,29175,29063,29495,28759,29191,29127,28887,29223,29335,29127,29143,29095,28727,29175,29303,28967,29207,29719,29079,28759,29111,29255,28743,29095,28775,29015,28759,29127,28903,28807,29063,29607,29111,29175,28903,28839,29383,29303,29095,28759,29159,29015,29159,28967,29031,29047,29095,28839,29223,29047,29015,28967,28887,28887,29271,28839,28711,28999,28983,29383,29111,29191,28791,29207,28935,29143,28630,28454,28807,29399,29079,29095,28983,29111,29127,29063,29143,29031,29463,29031,28871,28983,29447,28839,29191,29335,29559,29079,28903,28775,28935,28935,28967,29079,29495,28727,28999,28855,28999,28711,28727,29383,28903,28791,29287,29591,28582,29319,28598,29399,29127,29031,28791,28999,28807,28695,29207,29335,29287,29239,29095,29079,28935,28903,29079,28823,28695,28903,29047,28983,28679,28823,29207,28871,29111,28614,28743,29063,28999,29015,28823,29207,29383,29287,28871,29015,29015,28823,28967,29079,28935,29255,29079,29175,28791,28679,29431,28999,29031,29463,29047,29127,28743,29319,29143,28967,29079,29111,29255,29415,29287,29175,28967,29127,29095,28999,29047,28807,29031,29031,28951,28967,29079,29335,29143,29239,29159,28871,29127,29015,28983,29047,29111,29479,29271,29239,28759,28935,29047,28855,29063,29239,29223,29079,28646,29383,29207,29079,28951,28791,29111,29271,28791,29031,28807,28951,29367,28679,29575,28791,29015,29063,29223,28871,29447,29159,29047,29111,29447,29511,29207,29079,29239,29127,29303,29031,29239,28839,28951,28903,28775,28983,28903,29815,28807,29303,29367,28919,29079,29015,28983,29127,28983,29127,29175,29063,28823,28486,29223,28951,29159,29095,28727,28855,28935,28999,29927,28871,29175,29143,29079,29015,28727,28999,28935,28711,29207,28887,29207,29207,28983,29335,29063,29143,29399,29479,29367,29095,29015,29415,29207,29079,29143,29239,28951,29271,29175,29463,29063,28807,28262,29239,30071,29031,29127,28951,28759,28823,29239,28550,28999,29111,29111,28598,29303,28823,29447,29271,29255,29015,29111,28695,28823,29175,28855,29095,29287,28935,28919,29271,28919,29015,28775,29159,28695,28919,29239,28935,29255,29271,28887,29127,28502,28871,29175,29591,29319,28727,29063,29127,29255,29303,29095,29239,28999,28999,28983,29223,29159,29319,28887,28951,29463,29527,29047,29207,29095,29223,29159,28967,28598,28919,29207,29159,29031,28951,28807,28935,29415,29159,29591,28871,29159,29063,29207,29383,29127,28983,28486,29287,28727,28935,28951,28839,29031,28903,28775,29319,28839,28935,29063,28983,28871,29175,29127,28919,28855,29095,28983,28695,29735,29047,29175,29079,29143,29127,28967,28679,29431,28887,28855,28983,29095,29575,28855,28807,28727,29063,28919,28646,29287,29191,28999,29223,28759,29095,28967,29719,29495,29015,29191,29271,29127,29159,29191,29319,29575,29095,29063,29111,28951,28662,29191,28887,28839,29735,28727,29175,29511,28935,28823,28839,28855,29063,28951,28887,29047,29079,28903,28550,29255,28983,29367,29111,28951,29063,29031,28775,29031,28967,29127,28999,29303,28903,28871,28983,29079,29447,28679,28791,29431,28534,28839,29031,29175,28919,29463,29207,29383,29063,28390,29223,29191,29207,29303,28919,28727,29351,28823,29143,28919,29415,28935,29319,28775,29047,28967,28935,29143,29431,29543,28839,28903,29143,29319,29095,29431,28967,29303,28807,29399,28518,28855,27974,27734,27302,26310,26070,25302,24886,23685,23061,21845,21493,20485,20084,19892,19412,18628,18820,18692,18980,19588,19780,20709,21397,22325,23013,24806,25382,26662,26966,27910,28198,28775,28759,29031,29175,28566,29079,28999,28839,28823,29143,29095,29303,28791,28743,29191,29127,29415,28743,29543,29351,28823,29031,29127,28935,29463,29207,29575,29319,29303,28823,29079,29191,29079,28903,29383,28919,29191,28999,28582,28823,28598,28743,29255,29351,29015,29015,28871,28775,28759,28887,28871,29175,29079,28486,29207,29287,29175,28791,29127,29095,29127,28983,28967,29143,29175,28855,28999,29143,28502,29255,29159,29479,28823,28999,28662,28951,28662,29079,29447,29223,28598,28791,28967,28951,29207,29239,29175,28951,29271,28775,29207,29159,28919,29543,29159,28855,29239,28695,29047,29143,28791,29063,29079,28919,29015,28983,29383,29303,29047,28935,28903,29127,29111,28919,29063,29239,29127,28727,28679,29111,29015,28630,29223,29047,28518,28727,29111,29191,28711,29047,29143,28791,28759,28775,29239,28775,28967,28759,29095,29271,28695,29079,29431,28887,29143,29079,29143,28951,29095,28598,29351,29143,29303,28855,29319,28887,28935,28951,29319,28887,28903,28775,28598,29191,29175,28999,29159,29255,29095,29127,28839,29047,28935,30743,29335,28935,28999,28630,28999,28582,29271,29143,29447,28999,28759,28791,29351,29095,28807,29047,28983,28887,28887,28983,28999,28855,28422,28775,29191,29383,28935,28951,29079,29415,29351,28951,29111,28967,29159,28903,29047,28951,29335,28695,29159,28791,28983,29047,29783,29031,29511,28855,28679,29255,29303,29335,28999,29287,29223,28935,29271,29431,28679,28919,28983,28855,28871,28999,28887,28823,29127,29463,29383,28951,28903,28983,29543,29063,28679,28999,29287,28951,29143,28951,29143,28807,29191,28903,28855,29191,28935,29031,28919,29271,28871,29207,29239,28887,28967,29095,29015,28967,28855,28823,28759,29335,29143,29063,29351,29095,28662,29063,28727,29127,29095,29015,29095,29143,28679,28759,29159,29223,29367,28679,29351,29015,29607,29255,29031,29015,28839,28887,29127,28935,28662,28967,29079,29191,28759,28662,29159,29191,28903,28887,28807,28646,29207,29479,29095,29415,29175,29143,29175,29015,28967,28855,29207,29079,28999,28919,29015,28919,28566,28839,29175,29287,28727,29111,29367,29095,28967,28999,28951,28903,28983,29063,29751,29095,28871,28871,29079,29127,28999,28839,29415,28935,29223,28807,29303,28630,29143,29319,29111,29159,29559,28662,29143,29079,29111,29175,28967,28951,29207,29351,29063,29463,29111,28743,28695,28839,28807,29079,29111,28630,28839,28983,28983,28999,28935,28871,28566,29047,28983,29367,29335,28855,28711,28951,28951,29111,28807,29287,28695,28999,29079,29111,28935,28807,28807,29079,29127,29031,29223,28759,29575,29047,28711,29015,29223,28839,29255,28887,29239,29191,29159,28823,29015,28871,29143,29079,29159,29063,28935,29047,28951,28422,29239,29015,28983,29095,28903,28935,28999,29015,29111,28855,29207,29239,29095,28695,29143,29079,29015,28935,28775,28823,29079,28887,28839,29127,28518,28855,28534,29015,29015,28887,29159,28630,28999,29031,29111,28983,28502,28614,28839,29111,29031,28743,28871,28807,28646,29063,29143,29143,28855,28775,28855,28983,28695,28999,29207,29447,28823,29063,29015,28999,29095,29479,28983,29239,28919,28871,29239,29223,28935,29047,28839,29143,28582,29063,29191,28855,28775,28470,28614,28855,28871,28630,29047,28871,29271,28919,29271,29319,28967,29159,28695,29175,28951,28727,28614,28727,29223,28935,29079,29191,28791,29095,28743,29143,28935,29335,29175,29079,28711,28759,29207,29047,28566,28999,28919,29463,28550,29159,28775,29111,28951,28887,29047,29111,28518,28662,28855,29271,29127,29015,29111,29063,28342,29095,28791,28518,28951,28646,28903,29111,29383,28807,29319,28839,28919,28662,29207,29303,29239,29175,29175,28278,29239,29047,29319,28743,28695,28935,28695,28983,29159,28807,28903,29255,29287,29175,28999,28695,28646,29047,29335,28887,28743,29447,28791,29255,29223,28935,29111,29063,29047,28871,28903,29079,28887,29047,29463,28807,28775,28999,29447,28855,28935,28390,28679,28855,28759,28743,28759,29095,28935,28695,29207,28711,28775,28807,29239,29287,29559,29319,29495,28518,29127,29047,29095,29095,28919,29191,29031,29159,28598,28887,28791,29015,29063,28999,28358,28662,28887,28999,28951,29175,29143,28695,29207,29015,28614,29047,29031,29367,29175,28919,28871,28983,29079,28743,29303,29175,28743,29383,28614,29031,28582,28903,28566,29079,29015,29815,28695,29095,28342,29319,29127,29207,28214,29223,28598,29143,29479,29079,29191,28614,29191,29063,28887,28855,28823,29111,29031,28743,28775,28438,29159,29111,28823,28630,28839,28999,28775,29063,28759,28759,28887,29287,29191,29207,28791,29159,29191,28983,29095,29319,29111,28662,29127,28823,28903,29175,28566,28823,29303,28759,28919,29143,28646,28999,29127,29527,28759,28983,28775,29111,29303,28679,28983,29063,28935,29079,28983,29015,28759,29015,28967,29111,28823,28791,28935,28919,28711,29319,28999,29063,29063,29095,28550,28887,28582,28919,28470,28582,28983,28855,28566,28967,29335,28855,28855,29287,29079,29319,29319,29303,29287,28470,29255,29239,29399,28727,28791,29335,29447,28887,29063,29127,28759,29063,29095,29159,28903,28855,28727,28871,28646,28695,28855,28903,28887,28919,28855,28935,29543,29159,29335,28791,28935,28759,29367,28919,28871,28695,29271,28983,29415,28919,28582,28695,28630,29127,28278,28903,28518,28727,28759,28791,29015,28807,28855,29063,28903,29031,29255,29047,28807,28582,29223,29207,29735,28823,29655,29111,28646,28855,29127,28598,29207,28759,28727,28662,28711,28999,28598,28791,29303,28695,29063,29367,28566,28807,28502,29079,29703,29479,29271,29047,29063,29047,29271,29031,29095,28887,28871,29079,28759,28823,29015,29175,28695,29223,28743,29495,28967,28743,28823,29287,29479,28791,29575,28935,28262,29159,29255,28823,28582,29127,29079,29031,29031,28951,28743,29063,28662,28743,28871,28743,28935,28919,28374,29111,28743,28823,28871,29063,29111,28614,29015,28759,28502,29175,28630,29095,29063,28711,29623,28727,29431,28727,29143,28695,28903,28983,28967,28887,29191,28630,29335,29127,28310,29239,28775,29239,28935,29303,28438,29031,28871,28727,29479,29159,28646,29207,29127,28983,29271,29031,28935,29271,29127,29175,29207,28695,28695,28983,29335,29127,29095,28775,29047,28662,29111,28743,28871,29127,28550,28454,28919,29191,29047,28759,29175,29015,28919,28999,29255,29111,29239,28454,28887,29015,28951,28646,28903,28727,28967,28887,29143,29047,28550,28887,28871,28903,28598,28791,28470,28695,28679,29543,29655,29399,28807,28823,28919,28807,29111,29175,29175,29511,29095,28855,29543,29031,28951,28566,28807,28743,29207,28919,28454,29015,28486,28999,28582,29287,28839,29191,28903,29159,29063,28598,28518,29239,28630,28887,29463,28662,29239,28198,29015,29095,29511,28807,29319,29191,28118,28374,29111,28727,28871,28999,28550,28839,28807,29207,29047,29079,28935,28630,29175,28935,28518,29031,28679,28598,29415,29303,28983,28967,29111,28791,28983,28967,29463,28983,28903,28871,29111,28727,28951,28695,28919,29159,28422,29287,28951,28695,28743,29015,28983,28711,28646,29271,28662,28967,29255,28887,29063,29015,28662,28919,29511,29079,29319,29303,28919,29175,29223,29175,28791,29175,28646,28598,28406,29191,28550,28743,29063,29015,29063,29303,29015,28999,28935,28871,29063,29175,29175,28903,28919,28807,29335,28903,28791,28935,29031,29783,29159,28951,28695,29031,28791,29015,29127,29959,28662,28775,28182,29383,28614,28727,29175,29351,29223,28887,29287,28518,29191,29095,28903,28855,28951,29111,29223,28855,28967,28807,29047,28598,28759,28358,28326,27974,27478,26742,25654,25334,24405,23893,22805,21989,20468,20084,19140,18372,17396,16724,15987,15411,16035,14675,15619,16532,17284,18068,19268,21013,20981,22821,24421,25270,26262,27030,27686,28374,28695,28855,28903,28775,28887,29079,29127,29223,28887,28983,29207,28999,29463,28775,28662,29335,28855,28967,29047,28807,28582,28871,28807,28967,28566,28679,29095,29127,28983,29063,27926,29495,28727,29111,28711,29031,28951,28727,28903,29015,29063,29159,29159,28951,28935,28534,29063,28887,28759,28887,29079,29015,28550,28598,28887,28775,28727,28967,28855,29095,29079,29143,28743,29223,28518,29015,28887,29063,29079,28679,29159,28935,29271,29303,28727,28823,29047,29207,28855,28759,28951,28983,29111,29047,29047,28550,28727,29735,29287,28935,28871,28630,29111,29511,28791,29063,28919,28903,28903,29191,29031,29255,29255,29015,28967,28534,28775,29095,29255,29527,29079,28727,28903,28807,29063,29015,29367,29047,28086,29127,29143,28871,28534,28967,28662,29287,29223,28807,29015,29015,28775,29111,29207,29095,28919,28775,28855,28807,28951,28887,28807,28887,28807,29271,28438,28919,29159,29303,28999,28967,28983,29079,28951,28743,28582,29095,29015,29191,28935,29479,28823,28919,28855,29015,29959,29079,29079,28935,29143,29239,29207,29095,28887,28903,28695,28903,28374,28679,28983,29031,29223,28759,28967,28743,28983,28839,28919,28807,28438,29047,28823,29063,28743,29015,28967,28951,29127,28983,28743,28935,28614,28935,29623,29175,29351,29047,28855,29463,28887,28919,28871,28951,29111,28999,28743,29175,29175,29063,29047,28470,28903,29047,29463,28967,28807,28839,28983,28743,28662,28983,28935,28967,28951,28743,29159,28759,29175,28807,29031,28983,28999,28711,28951,29063,28679,28935,28646,28630,28775,28839,28903,29079,28294,28823,28855,28983,28951,28951,28711,28807,28791,28326,29047,28871,28711,29159,29127,28871,29031,28807,29175,29223,28999,28983,28518,28903,28791,29015,28967,28999,29127,28983,29303,29175,28775,28550,28951,28839,28871,28614,28646,28791,28759,28823,29223,28855,28839,28839,29415,28102,29207,28871,28759,28566,28967,29143,28823,28598,28743,28727,29175,28807,29271,28983,29127,28807,28839,28711,28903,28598,29191,29159,28935,29159,29367,28919,28951,28983,28775,28983,29175,29063,28983,29095,28935,29079,29175,28983,29255,28983,28534,28743,29207,28743,28662,28646,29031,28775,29015,28887,28518,28951,28887,28967,29191,28759,28566,28743,29239,28662,29079,28807,29447,28566,28999,29015,29239,28983,29127,28951,29271,29031,28983,29031,28935,29207,29015,29095,28711,28807,28823,28999,28919,28983,28999,28855,29271,28951,29239,28791,28919,29655,28662,28775,28999,28807,29255,29047,29463,28823,28534,28823,29015,28454,28470,28919,28775,28871,29143,28855,28759,29127,28807,29079,29415,28502,28711,28759,28727,29463,28695,28887,28775,28759,29303,29127,29047,29095,28919,28983,29095,29095,28646,28711,29175,28967,28550,28887,28807,29063,28630,29239,29143,28823,28214,28855,29239,28839,28743,28791,28823,28759,29223,28342,29015,28935,28951,29255,29319,29575,28855,28999,29559,28695,29191,29207,29063,28839,28919,29255,28951,28839,28406,29271,28967,29239,28983,29047,28807,29207,28999,28967,29111,28967,28983,28887,28807,28662,28743,28951,28743,28807,28630,28454,29575,29047,28679,28935,29175,28855,28454,28711,28903,28823,28486,28695,29063,28711,28823,29015,28951,29047,29159,28903,29255,29207,28999,29127,29127,28967,28662,29159,28534,28775,29095,28935,29031,29223,28887,28679,28951,28662,28935,28871,28967,28951,29079,28454,29015,28887,28919,28887,29495,28967,29111,28791,29143,28727,29367,28903,28839,28662,28662,28534,29463,29127,28646,28999,28727,28550,28935,28887,28614,28999,29303,29079,29207,28775,28775,28983,28935,28486,29175,29207,28903,28791,28935,29223,29063,29047,29303,28935,29127,29079,28775,28903,28438,28919,28374,28839,29463,29079,28951,28839,28951,28518,29063,28903,28903,29159,28887,28919,29191,28727,28999,29063,29015,28823,28662,29063,29127,29079,28534,29479,28887,28919,28182,29159,28727,28823,28630,29351,29175,28662,28454,29271,28695,28967,29479,29223,28759,28807,29399,28695,29047,28935,29303,28871,29191,28759,28807,29063,28967,28550,29335,28871,28919,28935,28887,29031,29079,29095,28695,28903,28775,28823,28598,28983,29063,29223,28502,28951,28951,28775,28999,28999,28999,28743,28871,28871,29367,28919,28598,28759,28582,29047,29079,28903,28983,28967,28951,28919,28967,28839,28807,28967,29111,29031,29207,28887,28582,28406,28903,29063,29143,28919,29159,29191,28983,28566,29031,28935,28262,29031,28855,28630,28935,28775,28422,28839,29047,28935,28374,28967,28775,29015,28502,28903,29239,28630,28823,29367,28614,28935,29399,28711,29319,28294,28919,28855,29671,29271,28743,28871,29495,28646,29431,28903,29095,29127,29287,45579,28823,28550,28871,29239,28951,28871,28887,28871,28711,28983,29223,28903,29303,29127,28855,28967,29399,28983,29111,28903,28903,29191,28646,29239,29159,28727,28791,28630,28807,28855,28614,29255,28438,28598,28951,28951,29351,28614,28662,28759,28630,28807,29463,28743,28711,28679,28695,29255,29367,28855,28823,29239,28711,28582,29063,28871,29031,29143,28486,28646,28823,29319,29031,28887,28630,28967,29143,28598,29255,29239,28967,29063,29367,28823,29143,28871,29367,28646,29223,28775,29223,29191,29063,28630,29463,28727,29335,29047,28903,28791,28582,29271,29191,28422,28486,28951,28791,28695,29255,29223,28839,28759,29095,29015,28566,28887,28598,28983,28903,28839,28791,28999,28887,29623,29175,28727,28967,29095,28679,29047,29207,28983,28999,29223,28807,28775,29095,28502,30151,29079,28999,28855,28903,28759,28743,28855,29335,28614,28919,28903,29175,28903,29175,28935,28999,28823,29415,28743,29095,29079,28534,29207,28823,28871,28406,29239,29047,28438,29159,28550,28887,29335,29079,28999,29591,29335,28839,29319,28967,28951,29127,29063,28566,29111,29127,28823,29047,28903,28775,29319,28679,28582,28679,29287,29047,28967,28951,28630,28791,28470,28839,28967,29287,29015,29047,28967,29063,28775,28646,44410,29287,29159,29399,29463,28630,28791,28887,28582,28743,28983,28598,28855,28807,28935,28630,28871,28839,28935,28646,28727,28791,28839,29063,28759,28775,28807,28967,28855,29399,28855,28743,28903,29063,29015,28887,28983,29031,28967,29015,29111,28951,28550,28486,29319,28807,28967,29031,28983,28727,28903,28807,29367,28711,29207,28871,28967,29063,28630,29015,28951,29479,28855,28727,29175,28695,28662,28887,28823,29095,28743,28470,29271,28855,29015				
		double sampleRateHz = 1000.0;
		double sampleInterval;
		const int LOG_MAX_LEN = 4096;

		public enum Pd_state : int {
			Normal = 0, 
			Neg_slope, 
			Notch, 
			Pos_slope 
		}
						
		public MainForm()
		{
			//
			// The InitializeComponent() call is required for Windows Forms designer support.
			//
			InitializeComponent();
			
			//
			// TODO: Add constructor code after the InitializeComponent() call.
			//
			sampleInterval = 1.0 / sampleRateHz;
				
			CreateGraph();
			BtnFindComClick(this, null);
		}
				
		public void ExceptionHandler(Exception ex)
		{
			timer1.Enabled = false;
			//MessageBox.Show(ex.ToString());
			Debug.WriteLine(ex.ToString());
			//Application.Exit();
		}
		
		void BtnFindComClick(object sender, EventArgs e)
		{
			ManagementObjectCollection mbsList = null;
            ManagementObjectSearcher mbs = new ManagementObjectSearcher("Select * From Win32_PnPEntity WHERE ConfigManagerErrorCode = 0");
            mbsList = mbs.Get();
			
            cbPorts.Items.Clear();
            
            foreach (ManagementObject mo in mbsList)
            {
            	string str = mo["Name"].ToString();
            	if (str.IndexOf("(COM") != -1) 
            	{           	
	                Debug.WriteLine(str);
	                if (str.IndexOf("mbed") != -1) 
	                {
		                string portStr = str.Substring(str.IndexOf("COM"));
		                portStr = portStr.Replace(")", "");
		                cbPorts.Items.Add(portStr);	                	
	                }
            	}             	
            }                     
			
            /*´string[] portList = System.IO.Ports.SerialPort.GetPortNames();
			foreach (string port in portList)
			{
				cbPorts.Items.Add(port);
			}*/
			
			if (cbPorts.Items.Count > 0)
			{
				cbPorts.SelectedIndex = 0;
				btnConnect.Enabled = true;
			}
			else
			{
				btnConnect.Enabled = false;
			}
		}
		
		void BtnConnectClick(object sender, EventArgs e)
		{
			try {
				if (btnConnect.Text == "Connect")
				{			
					OpenCom(cbPorts.SelectedItem.ToString());
					btnConnect.Text = "Disconnect";	
					Debug.Print("Connected successfully");
					btnSend.Enabled = true;
				}
				else
				{
					CloseCom();
					btnConnect.Text = "Connect";
					Debug.Print("Disconnected successfully");
					btnSend.Enabled = false;
				}
			}
			catch (Exception ex) {
				ExceptionHandler(ex);
				btnSend.Enabled = false;
			}			
		}
				
		public delegate void UpdateTextCallback(string p_text);
		
		// Updates the textbox text.
		private void UpdateText(string p_text)
		{
			if (p_text.IndexOf("out.txt") != -1)
			{
				ProcessData(p_text);
				return;
			}
			
			// Don't print large data
			if (p_text.Length > 100) return;
					
			tbData.Text += p_text + "\r\n";

			// Remove older log information
			int len = tbData.Text.Length - LOG_MAX_LEN;
			if (len >= 0)
			{
				tbData.Text = tbData.Text.Substring(len);
			}
			
			//Autoscroll to the end
			tbData.SelectionStart = tbData.Text.Length;
			tbData.ScrollToCaret();			
		}		
		
		void BtnClearClick(object sender, EventArgs e)
		{
			tbData.Text = "";
		}
				
		void MainFormFormClosed(object sender, FormClosedEventArgs e)
		{
			serialPort1.Close();
			Debug.Print("Disconnected successfully");
		}
		
		void BtnSendClick(object sender, EventArgs e)
		{
			SendCommand(tbSend.Text + "\r\n");	
		}
		
		void TrackBarPotValueValueChanged(object sender, EventArgs e)
		{
			if (string.IsNullOrEmpty(tbSend.Text))
			{
				var hexValue = trackBarPotValue.Value.ToString("X2");
				labelPotValue.Text = "0x" + hexValue;
				var cmd = "W:" + hexValue + "\r\n";
				//UpdateText(cmd);
				SendCommand(cmd);
			}
		}
		
		void BtnExportGraphClick(object sender, EventArgs e)
		{
   			zg1.SaveAsBitmap();
		}	
		
		void Button2Click(object sender, EventArgs e)
		{
			
			/*unsafe
			{
				string s = "";
						const int SAMPLE_BUF_SIZE = 32;
						const int TX_BUFFER_SIZE = 8;
						int* wp;
						int* rp;
						int sampleCount = 0, blockCount = 0;
						
						int[] sampleBuf = new int[SAMPLE_BUF_SIZE];
						
			    fixed (int* p = &sampleBuf[0])
			    {
			    		wp = p;
			    		rp = p;
			    		for (int i = 0; i < (SAMPLE_BUF_SIZE * 4); i++)
			    		{
					        s = string.Format("i:{0}, blockCount:{1}, sampleCount:{2}, diff:{3}", i, blockCount, sampleCount, wp-p);
					        Debug.WriteLine(s);
					        if ((wp - p) >= (SAMPLE_BUF_SIZE - 1)) {    
					            wp = p;
					            sampleCount = 0;
					            blockCount = 0;
					            Debug.WriteLine("*** Buffer full *** -> GO to start");
					        }
					        else {
					            wp++; 
					            sampleCount++;                       
					                
					            if (sampleCount > 0 && (sampleCount % TX_BUFFER_SIZE) == 0) {
					                blockCount++;
					                rp = wp - TX_BUFFER_SIZE; 
					                //Thread::signal_wait(PROCESSING_SIGNAL);	
					                s = string.Format("SIGNAL! - read pointer:{0}", new IntPtr(rp));
					                Debug.WriteLine(s);
					            }
					            //led1 = !led1;      
					        }	
			    		}
			    }
			}*/
			
			//ProcessData();
			//MessageBox.Show(GetMbedDriveLetter());
			
			/*
			string str = "Datalogger_v1\r\n" + 
				"interval: 5000 Hz\r\n" +
				"Reading ADC...\r\n" +
				"Results:\r\n" +
				recData;
			
			//tbData.Text = str;
			string[] buf = str.Split('\n');
			str = "";
			for (int i = 0; i < buf.GetLength(0); i++)
			{
				str += i.ToString() + ": " + buf[i] + "\r\n";
			}
			tbData.Text = str;*/
		}				
		
		void BtnResetZoomClick(object sender, EventArgs e)
		{
			zg1.ZoomOutAll(myPane);
		}
		
		void BtnAcquireClick(object sender, EventArgs e)
		{
			if (btnAcquire.Text == "ACQUIRE")
			{
				if (chkSingle.Checked == true)
				{
					//lblCount.Text = "0";
					SendCommand("d\n");
				}
				else{
					SendCommand("a\n");			
					btnAcquire.Text = "IDLE";					
				}
			}
			else
			{
				SendCommand("i\n");
				btnAcquire.Text = "ACQUIRE";
			}
		}
		
		void BtnSampleRateClick(object sender, EventArgs e)
		{
			sampleRateHz = ValidateNumber(tbSampleRate.Text);
			if (sampleRateHz > 0.0)
			{
				sampleInterval = 1 / sampleRateHz;
				SendCommand("s:" + tbSampleRate.Text + "\n");				
			}
		}
		
		void BtnSetLengthClick(object sender, EventArgs e)
		{
			double len = ValidateNumber(tbLength.Text);
			if (len > 0.0)
			{
				SendCommand("l:" + tbLength.Text + "\n");	
			}
		}
		
		void BtnExportDataClick(object sender, EventArgs e)
		{
			if (list.Count == 0) return;
			
			SaveFileDialog saveFileDialog1 = new SaveFileDialog();
   			saveFileDialog1.Filter = "Result data|*.txt";
   			saveFileDialog1.Title = "Export result data";			
   			saveFileDialog1.FileName = "result_data.txt";			
			
			// If the file name is not an empty string open it for saving.
			if(saveFileDialog1.ShowDialog() == DialogResult.OK)
			{
				StringBuilder sb = new StringBuilder();
				sb.Append("Time [ms],Voltage [V]").AppendLine();
				//string dataStr = "Time [ms],Voltage [V]\r\n";
				
				foreach (PointPair p in list)
				{
					//dataStr += p.X.ToString() + "," + p.Y.ToString() + "\r\n";
					sb.AppendFormat("{0},{1}", p.X, p.Y).AppendLine();
				}
				
				try
				{
					File.WriteAllText(saveFileDialog1.FileName, sb.ToString());
					//File.WriteAllText(saveFileDialog1.FileName, dataStr);
				}
				catch (Exception ex)
				{
					ExceptionHandler(ex);
				}
			}
		}
		
		void BtnImportDataClick(object sender, EventArgs e)
		{
			OpenFileDialog openFileDialog1 = new OpenFileDialog();
   			openFileDialog1.Filter = "Result data|*.txt";
   			openFileDialog1.Title = "Import result data";			
   			openFileDialog1.FileName = "result_data.txt";
			
			// If the file name is not an empty string open it for reading.
			if(openFileDialog1.ShowDialog() == DialogResult.OK)
			{
				try
				{
					list.Clear();
					//lblCount.Text = "";
					
					// Read file content line by line
					using (StreamReader sr = File.OpenText(openFileDialog1.FileName))
					{
						int i = 0;	
						string[] s_buf;
				        string s = String.Empty;
				        double x, y;
				        
				        while ((s = sr.ReadLine()) != null)
				        {
				        	// Ignore header line (1st line of file)
				            if (i > 0)
							{
				            	s_buf = s.Split(',');
				            	x = Double.Parse(s_buf[0]);
				            	y = Double.Parse(s_buf[1]);
								list.Add(x, y);
							}
							i++;							
				        }
					}	
					
					// Show filename in title bar
					this.Text = Application.ProductName + " (" + openFileDialog1.FileName + ")";
					
					// Update graph plot
					BtnResetZoomClick(this, null);
					UpdataGraph();
				}
				catch (Exception ex)
				{
					ExceptionHandler(ex);
				}				
			}			
		}
		
		void BtnAnalyzeClick(object sender, EventArgs e)
		{
			//lblCount.Text = "";
			StringBuilder sb = new StringBuilder();
			double delta;			
			double[] input = list.Select(pointPair => pointPair.Y).ToArray();
			double[] samples = new Double[input.Length];
			int decimateFactor = (int)numDecimateFactor.Value;
						
			// Filter signal by removing "glitches"
			for(int i=0; i<(input.Length - 1); i++) {
				if (i != 0)	
				{
					delta =  Math.Abs((input[i]-input[i-1])); // delta to previous sample
					
	                if (delta > 0.35) // Glitch
	                {
	                	input[i] =((input[i-1]+input[i+1])/2);	
	                	sb.AppendFormat("{0}:{1}", i, delta).AppendLine(); // Build debug string of glitch detected
	                }
	                
				}
	        }	
			Debug.WriteLine(sb.ToString());

			// Calculate moving average with SimpleRunningAverage class
			SimpleRunningAverage avg = new SimpleRunningAverage(4);			
			for(int i=0; i<input.Length; i++) 
			{
				samples[i] = avg.Add(input[i]);
	        }				

			// Build list2 with filtered values to plot a new curve in graph pane
			int j = 0;
			list2.Clear();
			foreach (PointPair p in list)
			{	
				// Decimate result data
				if (j % decimateFactor == 0)
					list2.Add(p.X, samples[j]);
				j++;
			}						
			
			// Loop to detect a drop from measurement data
			///////////////////////////////////////////////////
			// Threshold is 0.05 V (992 / 65535 * 3.3 V = 0.04995 V)
			int thresh = 794; // 794 = 0.04 V 
  			int dropCount = 0;
  			StringBuilder sb2 = new StringBuilder();
			samples = list2.Select(pointPair => pointPair.Y).ToArray();
			double xScale = (sampleInterval * decimateFactor) * 1000.0;
			Int16 dxsum = 0;
			
			list3.Clear();
			
			// Iterate sample buffer to detect drops
  			for(int i = 1; i < samples.Length; i++)
			{
				// Calculate delta between previous and current sample
	  			dxsum += (Int16)((samples[i-1]-samples[i])*65535.0/3.3);  				
	  			//sb2.AppendLine(i.ToString() + ": " + dx.ToString());
					  			
	  			if ((i % 2) == 0)
	  			{
	  				//sb2.AppendLine(i.ToString() + ": " + dxsum.ToString());
	  				// If sum exceeds threshold -> drop detected
	  				if (dxsum < (thresh * -2))
	  				{
	  					dropCount++;
	  					//list3.Add( (i-1) * xScale, samples[i-1]);
	  					list3.Add( (i-1) * xScale, 0.0);
	  					i += (100 / decimateFactor); // discard next samples to avoid double detect
  						if (i < samples.Length)
  							list3.Add(i * xScale, 0.0);
  						else
  							continue;
		  				//sb2.AppendLine(i.ToString() + ": " + dxsum.ToString());
	  				}
	  				dxsum = 0;
	  			}	  			
	  			else
	  			{
	  				  list3.Add( i * xScale, samples[i]);
	  			}
			}
  			Debug.WriteLine(sb2.ToString());
  			
  			// Update drop count
  			//lblCount.Text = dropCount.ToString();
  			
			// Add some y-offset into original measurement data
			/*foreach (PointPair p in list)
			{				
				p.Y += 1.0;
			}*/				

			// Plot curves in graph control
			myPane.CurveList.Clear();
			myAnalCurve = myPane.AddCurve( "filtered", list2, Color.Red, SymbolType.Circle);	
			myCurve = myPane.AddCurve( "p20(in)", list, Color.Blue, SymbolType.XCross);			
			myDropCurve = myPane.AddCurve( "drops", list3, Color.Black, SymbolType.Star);	
			
			zg1.AxisChange();
			zg1.Invalidate();
			zg1.Refresh();			
		}
      public void dummyAlgos()
      {
      	/*
			sbyte F_gfx_Cls = -51;
			sbyte[] towrite = new sbyte[4];
			towrite[0]= (sbyte)(F_gfx_Cls >> 8);
			towrite[1]= F_gfx_Cls ;
			towrite[2] = -1;
			towrite[3] = (0xCD)-256;
			for (int i = 0; i < towrite.Length; i++)
			{
				string s = string.Format("%X{0}", towrite[i]);
				Debug.WriteLine(towrite[i].ToString("X2"));
			}      	 
      	 */
      	/*
			lblCount.Text = "";
			StringBuilder sb = new StringBuilder();
			double delta;			
			double[] input = list.Select(pointPair => pointPair.Y).ToArray();
			double[] samples = new Double[input.Length];
			int decimateFactor = 10;			
			
			// Filter signal by removing "glitches"
			for(int i=0; i<input.Length; i++) {
				if (i != 0)	
				{
					delta =  Math.Abs((input[i]-input[i-1])); // delta to previous sample
					
	                if (delta > 0.35) // Glitch
	                {
	                	input[i] =((input[i-1]+input[i+1])/2);	
	                	sb.AppendFormat("{0}:{1}", i, delta).AppendLine(); // Build debug string of glitch detected
	                }
	                
				}
	        }	
			Debug.WriteLine(sb.ToString());

			// Calculate moving average with SimpleRunningAverage class
			SimpleRunningAverage avg = new SimpleRunningAverage(4);			
			for(int i=0; i<input.Length; i++) 
			{
				samples[i] = avg.Add(input[i]);
	        }				

			// Build list2 with filtered values to plot a new curve in graph pane
			int j = 0;
			list2.Clear();
			foreach (PointPair p in list)
			{	
				// Decimate result data
				if (j % decimateFactor == 0)
					list2.Add(p.X, samples[j]);
				j++;
			}						
			
			// Loop to detect a drop from measurement data
			int thresh = 992; // Threshold is 0.05 V (992 / 65535 * 3.3 V = 0.04995 V)
			int notchStart = 0;
			Pd_state state = Pd_state.Normal;			
  			Int16 dx = 0;
  			int dropCount = 0;
  			StringBuilder sb2 = new StringBuilder();
			samples = list2.Select(pointPair => pointPair.Y).ToArray();
			double xScale = (sampleInterval * decimateFactor) * 1000.0;
			int dxsum = 0;
			
			list3.Clear();
      	 
  				// Add dots to drop detect curve
  				if (state != Pd_state.Normal)
  				{
  					//list3.Add( i * xScale, samples[i]);
  				}
  				else
  				{
  					//list3.Add( i * xScale, 0.0);	
  				}

  				// Simple drop detect algorithm:
  				// Triggers state transition if threshold (delta) exceeds on negative slope
  				// Treshold needs to be exceeded by 3 consecutive samples
  				
  				// On positive slop, transition to normal state
  				if (state == Pd_state.Pos_slope)
  				{
  				    // Still in positive slope - drop detected
  				    if(dx <= (thresh * -1))
  				    {
	  					//dropCount++;  
	  					//list3.Add( i * xScale, samples[i]);
  				    }
	  				
  				    notchStart = 0;
	  				state = Pd_state.Normal;		  				 				
  				}

  				// On normal state, transition to positive slope
  				if ((state == Pd_state.Normal) && (dx <= (thresh * -1)))
  				{
  					notchStart = i;
  					state = Pd_state.Pos_slope;	
  					//list3.Add( i * xScale, samples[i]);
  				}
  				*/
  				
  				///////////////////////////////////////////////////////////////////
  				/*
  				// Notch detect algorithm (negative and positive slopes)
  				// On positive slope, transition to normal
  				if ((state == Pd_state.Pos_slope) && (dx <= thresh))
  				{  					
  					// Non-normal state elapsed <30ms -> increase notch counter!
  					//if ((i > (notchStart + 50)) && (i <= (notchStart + 150)))
  					if ((i <= (notchStart + 150)))
  					{
	  					state = Pd_state.Normal;	
	  					Debug.WriteLine("Normal state at " + i.ToString());

	  					dropCount++;
  					    Debug.WriteLine("Counter: " + dropCount.ToString());
  					}
  				}  				
  				// On notch, transition to positive slope
  				if ((state == Pd_state.Notch) && (dx <= (thresh * -1)))
  				{
  					state = Pd_state.Pos_slope;	
  					Debug.WriteLine("Pos. slope at " + i.ToString());
  				}  				
  				// On negative slope, transition to notch
  				if ((state == Pd_state.Neg_slope) && (dx <= thresh))
  				{
  					state = Pd_state.Notch;	
  					i++; // ignore next sample
  					Debug.WriteLine("Notch at " + i.ToString());
  				}
  				// Normal state, transition to negative slope
  				if ((state == Pd_state.Normal) && (dx >= thresh))
  				{
					notchStart = i;
					state = Pd_state.Neg_slope;	
					Debug.WriteLine("Neg. slope at " + i.ToString());
  				}  	
  				
  				// If non-normal state has elapsed > 40 ms
  				// some glitch has detected -> set state to normal
  				if ((state != Pd_state.Normal) && (i > (notchStart + 200)))
  				{
  					state = Pd_state.Normal;
  					notchStart = 0;
  					Debug.WriteLine("Glitch? Set normal at " + i.ToString());
  				} 
 				*/      	
      }		
	}		
}
